name: publish_Module_on_tag_Creation

on:
  workflow_dispatch:
  push:
    tags:
      - '*'
  release:
    types: [published]

permissions:
  contents: read

jobs:
  publish_Production:
    runs-on: ubuntu-latest
    environment: Production
    steps:
      - uses: actions/checkout@v3

      - env:
          EVENT_CONTEXT: ${{ toJSON(github.event) }}
        run: |
          echo $EVENT_CONTEXT

      - name: publish_ps1
        shell: pwsh
        run: | 
          $ref = "${{github.event.ref}}"
          $tag = $ref.Split('/')[2]
          ./publish.ps1 -VersionTag $tag -NugetApiKey "${{secrets.NUGETAPIKEY}}" -Whatif

     