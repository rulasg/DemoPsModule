name: TagCreation

on:
    push:
        tags:
        - 'v*'
    workflow_dispatch:

jobs:
  print_context:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - env:
          EVENT_CONTEXT: ${{ toJSON(github.event) }}
        run: |
          echo $EVENT_CONTEXT

      - name: Deploy
        shell: pwsh
        run: | 
          $ref = "${{github.event.ref}}"
          ./deploy.ps1 -ref $ref

      - name: Check commig
        shell: pwsh
        run: | 
          $VerbosePreference = 'Continue'

          $gitShow = git show -s
          $gitshow  | Write-Host
          
          $commit = $gitshow[0].Substring(7) 

          $tagref= "${{github.event.head_commit.id}}"

          "Actual commit [{0}] " -f $commit | Write-Host
          "ref    commit [{0}] " -f $tagref | write-host
          $equal = ($commit -eq $tagref)
          
          "Confirmed head commit [{0}]" -f $equal | Write-Host



        